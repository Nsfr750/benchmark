MakeNSIS v3.11 - Copyright 1999-2025 Contributors
See the file COPYING for license details.
Credits can be found in the Users Manual.

Processing config: c:\NSIS\nsisconf.nsh
Processing default plugins: "c:\NSIS\Plugins\x86-unicode\*.dll"
 + AdvSplash::show
 + Banner::destroy
 + Banner::getWindow
 + Banner::show
 + BgImage::AddImage
 + BgImage::AddText
 + BgImage::Clear
 + BgImage::Destroy
 + BgImage::Redraw
 + BgImage::SetBg
 + BgImage::SetReturn
 + BgImage::Sound
 + Dialer::AttemptConnect
 + Dialer::AutodialHangup
 + Dialer::AutodialOnline
 + Dialer::AutodialUnattended
 + Dialer::GetConnectedState
 + InstallOptions::dialog
 + InstallOptions::initDialog
 + InstallOptions::make_unicode
 + InstallOptions::show
 + LangDLL::LangDialog
 + Math::Script
 + NSISdl::download
 + NSISdl::download_quiet
 + Splash::show
 + StartMenu::Init
 + StartMenu::Select
 + StartMenu::Show
 + System::Alloc
 + System::Call
 + System::Copy
 + System::Free
 + System::Get
 + System::Int64Op
 + System::Store
 + System::StrAlloc
 + TypeLib::GetLibVersion
 + TypeLib::Register
 + TypeLib::UnRegister
 + UserInfo::GetAccountType
 + UserInfo::GetName
 + UserInfo::GetOriginalAccountType
 + VPatch::GetFileCRC32
 + VPatch::GetFileMD5
 + VPatch::vpatchfile
 + nsDialogs::Create
 + nsDialogs::CreateControl
 + nsDialogs::CreateItem
 + nsDialogs::CreateTimer
 + nsDialogs::GetUserData
 + nsDialogs::KillTimer
 + nsDialogs::OnBack
 + nsDialogs::OnChange
 + nsDialogs::OnClick
 + nsDialogs::OnNotify
 + nsDialogs::SelectFileDialog
 + nsDialogs::SelectFolderDialog
 + nsDialogs::SetRTL
 + nsDialogs::SetUserData
 + nsDialogs::Show
 + nsExec::Exec
 + nsExec::ExecToLog
 + nsExec::ExecToStack

!define: "MUI_INSERT_NSISCONF"=""

Changing directory to: "X:\GitHub\benchmark"

Processing script file: "installer.nsi" (ACP)
!include: "c:\NSIS\Include\MUI2.nsh" (UTF8)
!include: "c:\NSIS\Contrib\Modern UI 2\MUI2.nsh" (UTF8)
NSIS Modern User Interface version 2.1 - Copyright 2002-2025 Joost Verburg (c:\NSIS\Contrib\Modern UI 2\MUI2.nsh:14)
!include: closed: "c:\NSIS\Contrib\Modern UI 2\MUI2.nsh"
!include: closed: "c:\NSIS\Include\MUI2.nsh"
!include: "c:\NSIS\Include\FileFunc.nsh" (UTF8)
!include: closed: "c:\NSIS\Include\FileFunc.nsh"
!insertmacro: GetParameters
!insertmacro: end of GetParameters
!insertmacro: GetOptions
!insertmacro: end of GetOptions
!define: "APPNAME"="PyBench"
!define: "DISPLAY_NAME"="Benchmark Application"
!define: "PUBLISHER"="Nsfr750"
!define: "WEBSITE"="https://github.com/Nsfr750/benchmark"
!define: "INSTALLER_NAME"="PyBench_Setup.exe"
!define: "HELP_URL"="https://github.com/Nsfr750/benchmark/wiki"
!define: "UPDATE_URL"="https://github.com/Nsfr750/benchmark/releases/latest"
!define: "SUPPORT_EMAIL"="nsfr750@yandex.com"
!define: "DISCORD_URL"="https://discord.gg/BvvkUEP9"
!define: "MAJOR_VERSION"="1"
!define: "MINOR_VERSION"="3"
!define: "PATCH_VERSION"="0"
!define: "BUILD_NUMBER"="0"
!define: "VERSION"="1.3.0.0"
Name: "Benchmark Application"
OutFile: ".\dist\PyBench-v1.3.0.0-Setup.exe"
InstallDir: "$PROGRAMFILES64\PyBench"
InstallRegKey: "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\InstallLocation"
VIAddVersionKey: "ProductName" "Benchmark Application"
VIAddVersionKey: "CompanyName" "Nsfr750"
VIAddVersionKey: "LegalCopyright" "Â© 2025 Nsfr750"
VIAddVersionKey: "FileDescription" "Benchmark Application Installer"
VIAddVersionKey: "FileVersion" "1.3.0.0"
VIAddVersionKey: "ProductVersion" "1.3.0.0"
VIAddVersionKey: "InternalName" "PyBench"
VIAddVersionKey: "OriginalFilename" "PyBench-v1.3.0.0-Setup.exe"
VIAddVersionKey: "ProductVersionString" "1.3.0.0"
Var: "CreateDesktopSC"
Var: "AssocImages"
Var: "ReinstallUninstallString"
!define: "MUI_ABORTWARNING"=""
!define: "MUI_ICON"="c:\NSIS\Contrib\Graphics\Icons\orange-install.ico"
!define: "MUI_UNICON"="c:\NSIS\Contrib\Graphics\Icons\orange-uninstall.ico"
!define: "MUI_HEADERIMAGE"=""
!define: "MUI_HEADERIMAGE_BITMAP"="c:\NSIS\Contrib\Graphics\Header\orange.bmp"
!define: "MUI_HEADERIMAGE_UNBITMAP"="c:\NSIS\Contrib\Graphics\Header\orange-uninstall-r.bmp"
!define: "MUI_HEADERIMAGE_RIGHT"=""
!define: "MUI_WELCOMEFINISHPAGE_BITMAP"="c:\NSIS\Contrib\Graphics\Wizard\orange.bmp"
!define: "MUI_WELCOMEFINISHPAGE_UNBITMAP"="c:\NSIS\Contrib\Graphics\Wizard\orange-uninstall.bmp"
!define: "MUI_UNWELCOMEFINISHPAGE_BITMAP"="c:\NSIS\Contrib\Graphics\Wizard\orange.bmp"
!define: "MUI_FINISHPAGE_NOAUTOCLOSE"=""
!define: "MUI_UNFINISHPAGE_NOAUTOCLOSE"=""
!define: "MUI_UI_HEADERIMAGE_RIGHT"="c:\NSIS\Contrib\UIs\modern_headerbmp.exe"
!define: "MUI_UI_COMPONENTSPAGE_SMALLDESC"=""
!define: "MUI_UI_HEADERIMAGE"=""
!include: "c:\NSIS\Include\WinVer.nsh" (UTF8)
!include: closed: "c:\NSIS\Include\WinVer.nsh"
!include: "c:\NSIS\Include\x64.nsh" (UTF8)
!define: "___X64__NSH___"=""
!include: "c:\NSIS\Include\LogicLib.nsh" (UTF8)
!include: closed: "c:\NSIS\Include\LogicLib.nsh"
!define: "IsWow64"=""" IsWow64 """
!define: "RunningX64"=""" RunningX64 """
!define: "GetNativeMachineArchitecture"="!insertmacro GetNativeMachineArchitecture "
!define: "IsNativeMachineArchitecture"=""" IsNativeMachineArchitecture "
!define: "IsNativeIA32"=""" IsNativeMachineArchitecture  332"
!define: "IsNativeAMD64"=""" IsNativeMachineArchitecture  34404"
!define: "IsNativeARM64"=""" IsNativeMachineArchitecture  43620"
!define: "DisableX64FSRedirection"="!insertmacro DisableX64FSRedirection"
!define: "EnableX64FSRedirection"="!insertmacro EnableX64FSRedirection"
!include: closed: "c:\NSIS\Include\x64.nsh"
!define: "MUI_PAGE_CUSTOMFUNCTION_PRE"="SkipPageIfSilent"
!insertmacro: MUI_PAGE_WELCOME
!insertmacro: end of MUI_PAGE_WELCOME
!insertmacro: MUI_PAGE_DIRECTORY
!insertmacro: end of MUI_PAGE_DIRECTORY
!insertmacro: MUI_PAGE_INSTFILES
!insertmacro: end of MUI_PAGE_INSTFILES
!insertmacro: MUI_PAGE_FINISH
!insertmacro: end of MUI_PAGE_FINISH
!insertmacro: MUI_UNPAGE_CONFIRM
!insertmacro: end of MUI_UNPAGE_CONFIRM
!insertmacro: MUI_UNPAGE_INSTFILES
!insertmacro: end of MUI_UNPAGE_INSTFILES
!insertmacro: MUI_LANGUAGE
!insertmacro: end of MUI_LANGUAGE
!insertmacro: MUI_LANGUAGE
!insertmacro: end of MUI_LANGUAGE
Function: "SkipPageIfSilent"
!insertmacro: _If
!insertmacro: end of _If
Abort: ""
!insertmacro: _EndIf
!insertmacro: end of _EndIf
FunctionEnd
Function: ".onInit"
StrCpy $CreateDesktopSC "0" () ()
StrCpy $AssocImages "0" () ()
IfFileExists: "X:\GitHub\benchmark\dist\PyBench-1.3.0.0.exe" ? exe_found : 
MessageBox: 16: "Error: PyBench-1.3.0.0.exe not found at X:\GitHub\benchmark\dist\PyBench-1.3.0.0.exe"
Abort: ""
IfFileExists: "X:\GitHub\benchmark\assets\*.*" ? assets_found : 
MessageBox: 48: "Warning: assets directory not found at X:\GitHub\benchmark\assets"
IfFileExists: "X:\GitHub\benchmark\README.md" ? readme_found : 
MessageBox: 48: "Warning: README.md not found at X:\GitHub\benchmark\README.md"
IfFileExists: "X:\GitHub\benchmark\LICENSE" ? license_found : 
MessageBox: 48: "Warning: LICENSE not found at X:\GitHub\benchmark\LICENSE"
IfFileExists: "X:\GitHub\benchmark\CHANGELOG.md" ? changelog_found : 
MessageBox: 48: "Warning: CHANGELOG.md not found at X:\GitHub\benchmark\CHANGELOG.md"
ReadRegStr $R0 HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\UninstallString
StrCmp "$R0" "" equal=done, nonequal=
MessageBox: 36: "PyBench is already installed. 

Do you want to uninstall the previous version before continuing with the installation?" (on IDYES goto uninst)
Abort: ""
ClearErrors: 
ExecWait: "$R0 _?=$INSTDIR" (->)
IfErrors ?no_remove_uninstaller:
Delete: "$R0"
RMDir: "$INSTDIR"
IfErrors ?no_remove_folder:
RMDir: /r "$INSTDIR"
IfErrors ?+2:
Delete: "$DESKTOP\PyBench.lnk"
FunctionEnd
Section: "MainSection" ->(SecMain)
SetOutPath: "$INSTDIR"
SetOutPath: "$INSTDIR"
File: "PyBench-1.3.0.0.exe"->"Benchmark-1.3.0.0.exe" [compress] 40600734/40798720 bytes
IfFileExists: "$INSTDIR\Benchmark-1.3.0.0.exe" ? +3 : 
MessageBox: 16: "Failed to install Benchmark-1.3.0.0.exe to $INSTDIR"
Abort: ""
CopyFiles: "$INSTDIR\Benchmark-1.3.0.0.exe" -> "$INSTDIR\Benchmark.exe", size=0KB
IfFileExists: "X:\GitHub\benchmark\assets\*.*" ? assets_exist : 
MessageBox: 48: "Skipping assets: Source directory not found at X:\GitHub\benchmark\assets"
Goto: skip_assets
CreateDirectory: "$INSTDIR\assets"
IfFileExists: "$INSTDIR\assets" ? +3 : 
MessageBox: 16: "Failed to create directory: $INSTDIR\assets"
Goto: skip_assets
SetOutPath: "$INSTDIR\assets"
File: "icon.ico" [compress] 13920/73406 bytes
File: "logo.png" [compress] 13683 bytes
File: "screenshot.png" [compress] 11391/12225 bytes
File: "version-info.txt" [compress] 447/964 bytes
File: Returning to: "X:\GitHub\benchmark\assets"
IfFileExists: "$INSTDIR\assets\*.*" ? assets_installed : 
MessageBox: 16: "Failed to install assets to $INSTDIR\assets"
Goto: skip_assets
SetOutPath: "$INSTDIR"
SetOutPath: "$INSTDIR"
File: "README.md" [compress] 2019/4411 bytes
File: "LICENSE" [compress] 485/853 bytes
File: "CHANGELOG.md" [compress] 2235/6010 bytes
File: "TO_DO.md" [compress] 1123/2733 bytes
CreateDirectory: "$INSTDIR\logs"
CreateDirectory: "$INSTDIR\config"
CreateDirectory: "$INSTDIR\docs"
IfFileExists: "X:\GitHub\benchmark\config\*.*" ? 0 : +3
SetOutPath: "$INSTDIR\config"
File: "config.json" [compress] 86/109 bytes
File: "updates.json" [compress] 144/180 bytes
File: Returning to: "X:\GitHub\benchmark\config"
IfFileExists: "X:\GitHub\benchmark\docs\*.*" ? 0 : +3
SetOutPath: "$INSTDIR\docs"
File: "API.md" [compress] 1210/3341 bytes
File: "CODE_OF_CONDUCT.md" [compress] 1079/2322 bytes
File: "CONTRIBUTING.md" [compress] 1068/2106 bytes
File: "FAQ.md" [compress] 1384/2818 bytes
File: "PREREQUISITES.md" [compress] 1403/2940 bytes
File: "ROADMAP.md" [compress] 948/1885 bytes
File: "STRUCT.md" [compress] 1073/4292 bytes
File: "USER_GUIDE.md" [compress] 2299/5448 bytes
File: Returning to: "X:\GitHub\benchmark\docs"
MessageBox: 64: "Successfully installed README.md to $INSTDIR"
IfFileExists: "X:\GitHub\benchmark\LICENSE" ? license_exists : 
MessageBox: 48: "Skipping LICENSE: Source file not found at X:\GitHub\benchmark\LICENSE"
Goto: skip_license
File: "LICENSE" [compress] 0/853 bytes
IfFileExists: "$INSTDIR\LICENSE" ? license_installed : 
MessageBox: 16: "Failed to install LICENSE to $INSTDIR"
Goto: skip_license
MessageBox: 64: "Successfully installed LICENSE to $INSTDIR"
IfFileExists: "X:\GitHub\benchmark\CHANGELOG.md" ? changelog_exists : 
MessageBox: 48: "Skipping CHANGELOG.md: Source file not found at X:\GitHub\benchmark\CHANGELOG.md"
Goto: skip_changelog
File: "CHANGELOG.md" [compress] 0/6010 bytes
IfFileExists: "$INSTDIR\CHANGELOG.md" ? changelog_installed : 
MessageBox: 16: "Failed to install CHANGELOG.md to $INSTDIR"
Goto: skip_changelog
MessageBox: 64: "Successfully installed CHANGELOG.md to $INSTDIR"
WriteUninstaller: "$INSTDIR\uninstall.exe"
CreateDirectory: "$SMPROGRAMS\PyBench"
CreateShortcut: "$SMPROGRAMS\PyBench\PyBench.lnk"->"$INSTDIR\Benchmark.exe"  icon:,0, nwd=0, showmode=0x0, hotkey=0x0, comment=
CreateShortcut: "$SMPROGRAMS\PyBench\Documentation.lnk"->"$INSTDIR\docs\USER_GUIDE.md"  icon:,0, nwd=0, showmode=0x0, hotkey=0x0, comment=
CreateShortcut: "$SMPROGRAMS\PyBench\Uninstall.lnk"->"$INSTDIR\uninstall.exe"  icon:,0, nwd=0, showmode=0x0, hotkey=0x0, comment=
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\DisplayName=Benchmark Application
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\UninstallString="$INSTDIR\uninstall.exe"
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\QuietUninstallString="$INSTDIR\uninstall.exe" /S
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\DisplayIcon="$INSTDIR\Benchmark.exe",0
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\Publisher=Nsfr750
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\HelpLink=https://github.com/Nsfr750/benchmark/wiki
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\URLUpdateInfo=https://github.com/Nsfr750/benchmark/releases/latest
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\URLInfoAbout=https://github.com/Nsfr750/benchmark
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\DisplayVersion=1.3.0.0
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\VersionMajor=1
WriteRegStr: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\VersionMinor=3
WriteRegDWORD: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\NoModify=1
WriteRegDWORD: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\NoRepair=1
WriteRegDWORD: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\EstimatedSize=10240
WriteRegStr: HKCU\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\DisplayName=PyBench
WriteRegStr: HKCU\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\UninstallString="$INSTDIR\uninstall.exe" /currentuser
!insertmacro: _If
!insertmacro: end of _If
WriteRegStr: HKCR\.jpg\OpenWithProgids\PyBench.jpg=
WriteRegStr: HKCR\PyBench.jpg\=PyBench Image
WriteRegStr: HKCR\PyBench.jpg\DefaultIcon\=$INSTDIR\PyBench.exe,0
WriteRegStr: HKCR\PyBench.jpg\shell\open\command\="$INSTDIR\PyBench.exe" "%1"
WriteRegStr: HKCR\.jpeg\OpenWithProgids\PyBench.jpeg=
WriteRegStr: HKCR\.png\OpenWithProgids\PyBench.png=
WriteRegStr: HKCR\.bmp\OpenWithProgids\PyBench.bmp=
WriteRegStr: HKCR\.gif\OpenWithProgids\PyBench.gif=
WriteRegStr: HKCR\.tiff\OpenWithProgids\PyBench.tiff=
WriteRegStr: HKCR\.tif\OpenWithProgids\PyBench.tif=
WriteRegStr: HKCR\.webp\OpenWithProgids\PyBench.webp=
Plugin command: Call shell32.dll::SHChangeNotify(i, i, i, i) v (0x08000000, 0, 0, 0)
!insertmacro: _EndIf
!insertmacro: end of _EndIf
WriteUninstaller: "$INSTDIR\uninstall.exe"
SectionEnd
Section: "Desktop Shortcut" ->(SecDesktopShortcut)
StrCpy $CreateDesktopSC "1" () ()
SectionEnd
Section: "Associate Image Files" ->(SecFileAssoc)
StrCpy $AssocImages "1" () ()
SectionEnd
Function: "PageReinstall"
ReadRegStr $R0 HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench\UninstallString
StrCmp "$R0" "" equal=done, nonequal=
StrCpy $ReinstallUninstallString "$R0" () ()
MessageBox: 36: "PyBench is already installed. Uninstall previous version?" (on IDYES goto uninstall_previous)
Abort: ""
StrCpy $0 "$ReinstallUninstallString" () ()
ExecWait: "$0 /S _?=$INSTDIR" (->)
Delete: "$0"
RMDir: "$INSTDIR"
FunctionEnd
Function: "PageLeaveReinstall"
FunctionEnd
Section: "Uninstall"
Delete: "$INSTDIR\Uninstall.exe"
Delete: "$INSTDIR\Benchmark.exe"
Delete: "$INSTDIR\Benchmark-1.3.0.0.exe"
Delete: "$INSTDIR\uninstall.exe"
Delete: "$INSTDIR\README.md"
Delete: "$INSTDIR\LICENSE"
Delete: "$INSTDIR\CHANGELOG.md"
Delete: "$INSTDIR\TO_DO.md"
RMDir: /r "$INSTDIR\assets"
RMDir: /r "$INSTDIR\config"
RMDir: /r "$INSTDIR\docs"
RMDir: /r "$INSTDIR\logs"
RMDir: "$INSTDIR"
Delete: "$SMPROGRAMS\PyBench\PyBench.lnk"
Delete: "$SMPROGRAMS\PyBench\Documentation.lnk"
Delete: "$SMPROGRAMS\PyBench\Uninstall.lnk"
RMDir: "$SMPROGRAMS\PyBench"
Delete: "$DESKTOP\PyBench.lnk"
DeleteRegKey: HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench
DeleteRegKey: HKCR\Applications\PyBench.exe
File: "System.dll"->"$PLUGINSDIR\System.dll" [compress] 7092/12288 bytes
Plugin command: Call shell32.dll::SHChangeNotify(i, i, i, i) v (0x08000000, 0, 0, 0)
MessageBox: 64: "PyBench was successfully removed from your computer."
DeleteRegKey: HKCU\Software\Microsoft\Windows\CurrentVersion\Uninstall\PyBench
DeleteRegKey: HKLM\Software\PyBench
DeleteRegKey: HKCR\PyBench.jpg
DeleteRegKey: HKCR\PyBench.jpeg
DeleteRegKey: HKCR\PyBench.png
DeleteRegKey: HKCR\PyBench.bmp
DeleteRegKey: HKCR\PyBench.gif
DeleteRegKey: HKCR\PyBench.tiff
DeleteRegKey: HKCR\PyBench.tif
DeleteRegKey: HKCR\PyBench.webp
Plugin command: Call shell32.dll::SHChangeNotify(i, i, i, i) v (0x08000000, 0, 0, 0)
SectionEnd
Function: "LaunchApplication"
ExecShell: : "$INSTDIR\PyBench.exe" "" 
FunctionEnd

Processed 1 file, writing output (x86-unicode):
Adding plug-ins initializing function... Done!
warning 6010: install function "PageReinstall" not referenced - zeroing code (480-490) out

warning 6010: install function "PageLeaveReinstall" not referenced - zeroing code (490-491) out

warning 6010: install function "LaunchApplication" not referenced - zeroing code (491-493) out

warning 6012: label "skip_readme" not used
Processing pages... Done!
Removing unused resources... Done!
Generating language tables... Done!
Generating uninstaller... Done!

Output: "X:\GitHub\benchmark\dist\PyBench-v1.3.0.0-Setup.exe"
Install: 4 pages (256 bytes), 3 sections (6216 bytes), 512 instructions (14336 bytes), 347 strings (15548 bytes), 2 language tables (604 bytes).
Uninstall: 2 pages (192 bytes), 1 section (2072 bytes), 111 instructions (3108 bytes), 182 strings (6994 bytes), 2 language tables (508 bytes).
Datablock optimizer saved 11402 bytes (~0.0%).

Using zlib compression.

EXE header size:               65024 / 39936 bytes
Install code:                   6644 / 37424 bytes
Install data:               40680617 / 41082333 bytes
Uninstall code+data:           25787 / 38862 bytes
CRC (0xB31AEEBD):                  4 / 4 bytes

Total size:                 40778076 / 41198559 bytes (98.9%)

4 warnings:
  6010: install function "PageReinstall" not referenced - zeroing code (480-490) out

  6010: install function "PageLeaveReinstall" not referenced - zeroing code (490-491) out

  6010: install function "LaunchApplication" not referenced - zeroing code (491-493) out

  6012: label "skip_readme" not used
